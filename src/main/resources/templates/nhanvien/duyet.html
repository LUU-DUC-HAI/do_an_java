<!-- partial -->
<div class="main-panel">
  <div class="content-wrapper">
    <div class="row" id="proBanner">
      <div class="col-12">
      </div>
    </div>

    <!-- Page Header -->
    <div class="d-xl-flex justify-content-between align-items-start">
      <h2 class="text-dark font-weight-bold mb-2">Quản Lý Nhân Viên</h2>
      <div class="d-sm-flex justify-content-xl-between align-items-center mb-2"></div>
    </div>

    <!-- Notification Alert -->
    <div th:if="${THONG_BAO_OK}">
      <div class="alert alert-success" role="alert">
        <p th:text="${THONG_BAO_OK}"></p>
      </div>
    </div>

    <!-- Main Content -->
    <div class="container" style="margin-top: 20px;">
      <!-- Add Employee Button -->
      <a href="#" th:href="@{/qdl/nhanvien/them}"></a>
      <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#modalThem">
        <i class="bi-plus-circle"></i> Thêm Nhân Viên
      </button>

      <!-- Add Employee Modal Script -->
      <script>
        $('#modalThem').on('show.bs.modal', function (e) {
          $(e.currentTarget).find('form').attr('action', '/qdl/nhanvien/them');
        });
      </script>

      <!-- Filter Button -->
      <button class="btn btn-success" type="button" data-toggle="collapse" data-target="#filterBoxCollapsible">
        <i class="bi-filter"></i> Lọc
      </button>

      <!-- Employee Table -->
      <table class="table table-striped table-bordered mt-3">
        <thead class="thead-dark">
          <tr>
            <th>STT</th>
            <th>Tên Đăng Nhập</th>
            <th>Email</th>
            <th>Mật Khẩu</th>
            <th>Action</th>
          </tr>
        </thead>

        <tbody>
          <tr th:each="dl : ${ds}">
            <td th:text="${dl.id}"></td>
            <td th:text="${dl.TenDangNhap}"></td>
            <td th:text="${dl.email}"></td>
            <td th:text="${dl.MatKhau}"></td>

            <td>
              <!-- View Button -->
              <a th:href="@{/qdl/nhanvien/xem(id=${dl.Id})}" class="btn btn-success">
                <i class="bi-eye"></i> Xem
              </a>

              &nbsp;
              <!-- <a th:href="@{/qdl/nhasanxuat/sua(id=${dl.Id})}" title="Sửa"><i class="bi-pencil">sua</i></a> -->
              <!-- Edit Button with Modal Trigger -->
              <button type="button" class="btn btn-secondary" data-toggle="modal" data-target="#modalSua"
                th:data-id="${dl.id}">
                <i class="bi-pencil"></i> Sửa
              </button>

              <!-- Edit Modal Script -->
              <script>
                $('#modalSua').on('show.bs.modal', function (e) {
                  var id = $(e.relatedTarget).data('id');
                  $('#modalSua .modal-body').load("/qdl/nhanvien/suaajax?id=" + id);
                });
              </script>
              &nbsp;

              <!-- Delete Button with Modal Trigger -->
              <button type="button" class="btn btn-danger" data-toggle="modal" data-target="#modalXoa"
                th:data-id="${dl.id}">
                <i class="bi-trash"></i> Xóa
              </button>

              <!-- Delete Modal Script -->
              <script>
                $('#modalXoa').on('show.bs.modal', function (e) {
                  var id = $(e.relatedTarget).data('id');
                  // Set the ID in a hidden input within the modal
                  $(e.currentTarget).find('input[name="id"]').val(id);
                });
              </script>
            </td>

          </tr>
        </tbody>

        <tfoot>
          <tr>
            <th colspan="11" style="text-align: center;font-weight: bold">
              Tìm thấy <span th:text="${ds.size()}">xxx</span> bản ghi
            </th>
          </tr>
        </tfoot>

        </tfoot>

      </table>

      <script>
        $(function () {
          $.contextMenu({
            selector: 'table.bs4 tr',
            callback: function (key, options) {
              rowId = $(this).data('id');

              var m = "clicked: " + key;
              window.console && console.log(m + rowId) || alert(m + rowId);

            },
            items: {
              add: {
                name: "Thêm (Add)",
                icon: "fa-plus",
                callback: function (itemKey, opt, e) {
                  $.get("/qdl/nhanvien/ajax/modal",
                    content => {
                      $(content).modal();
                      $('.HtmlEditor').summernote();
                    })
                }
              },
              edit: {
                name: "Sửa (Edit)",
                icon: "fa-pencil",
                callback: function (itemKey, opt, e) {
                  rowId = $(this).data('id');
                  $.get("/qdl/nhanvien/ajax/modal?id=" + rowId,
                    content => {
                      $(content).modal();
                      $('.HtmlEditor').summernote();
                    })
                }
              },
              delete: {
                name: "Xóa (Delete)",
                icon: "fa-trash",
                callback: function (itemKey, opt, e) {
                  rowId = $(this).data('id');
                  rowTen = $(this).data('ten');
                  $('#modalXoa').modal();

                  $('#modalXoa input[name="id"]').val(rowId);

                  $('#modalXoa #textXacNhanXoa').text(`Bạn có chắc muốn xóa bản ghi có mã định danh là ${rowId} (${rowTen}) ?`);

                }
              },
              details: {
                name: "Xem Chi Tiết",
                icon: "fa-eye",
                callback: function (itemKey, opt, e) {
                  rowId = $(this).data('id');
                  $('#modalXem').modal();
                  $('#modalXem .modal-body').load("/qdl/nhanvien/xem-ajax/" + rowId);
                }
              },
              "sep1": "---------",
              "cut": {
                name: "Cut", icon: "cut", callback: function (itemKey, opt, e) {
                  var m = "Đang xây dựng chức năng Cut bản ghi";
                  window.console && console.log(m) || alert(m);

                  return false;
                }
              },
            }
          });

          $('table.bs4 tr').on('contextmenu', function (e) {
            console.log('Bạn đã bấm vào một item trên menu ngữ cảnh: ', this);
          })
        });
      </script>
    </div>
  </div>


  <!-- form them -->
  <div class="modal" id="modalThem">
    <div class="modal-dialog modal-xl">
      <div class="modal-content">
        <div class="modal-body p-0">
          <i th:replace="nhanvien/them.html"></i>
        </div>
        <!-- Modal footer -->
        <div class="modal-footer">
          <button type="button" class="btn btn-danger" data-dismiss="modal"><i class="bi-x"></i>Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- form Sửa  -->
  <div class="modal" id="modalSua">
    <div class="modal-dialog modal-xl">
      <div class="modal-content">
        <div class="modal-body p-0">
          Sử dụng Ajax để tải mã nguồn của thẻ Form Edit và đặt nó vào đây
        </div>
        <!-- Modal footer -->
        <div class="modal-footer">
          <button type="button" class="btn btn-danger" data-dismiss="modal"><i class="bi-x"></i>Close</button>
        </div>
      </div>
    </div>
  </div>



  <!-- form Xóa  -->
  <div class="modal" id="modalXoa">
    <div class="modal-dialog modal-xl">
      <div class="modal-content">
        <!-- Modal Header -->
        <div class="modal-header">
          <h4 class="modal-title"><i class="bi-trash"></i>Xác Nhận Xóa</h4>
          <button type="button" class="close" data-dismiss="modal">&times;</button>
        </div>

        <!-- Modal body: chú ý ràng buộc Controller Object vào Form -->
        <div class="modal-body">
          <form action="/qdl/nhanvien/xoa" method="post">
            <input type="hidden" name="id" th:value="${dl.id}" />
            <p>ID cần xóa: <span th:text="${dl.id}"></span></p>
            <button type="button" class="btn btn-secondary" data-dismiss="modal"><i class="bi-x"></i>Hủy</button>
            <button type="submit" class="btn btn-danger"><i class="bi-trash"></i>Xóa</button>

          </form>
        </div>

        <!-- Modal footer -->
        <!-- <div class="modal-footer">
                  <button type="button" class="btn btn-danger" data-dismiss="modal"><i class="bi-x"></i>Close</button>
              </div> -->

      </div>
    </div>
  </div>

</div>